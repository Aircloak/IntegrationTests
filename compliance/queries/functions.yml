---
mod:
- top-level: |-
    SELECT
      age % 20,
      mod(age, 20)
    FROM users
    GROUP BY 1, 2
    ORDER BY 1, 2
- sub-query: |-
    SELECT val, val2 FROM (
      SELECT age % 20 as val, mod(age, 20) as val2
      FROM users
    ) as users
    GROUP BY 1, 2
    ORDER BY 1, 2

concat:
- top-level: |-
    SELECT name || name, concat(name, name)
    FROM users
    GROUP BY 1, 2
    ORDER BY 1, 2
- sub-query: |-
    SELECT val, val2 FROM (
      SELECT name || name as val, concat(name, name) as val2
      FROM users
    ) as users
    GROUP BY 1, 2
    ORDER BY 1, 2

mult:
- top-level: |-
    SELECT age * 20
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT age * 20 as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

minus:
- top-level: |-
    SELECT age - 20
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT age - 20 as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

plus:
- top-level: |-
    SELECT age + 20
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT age + 20 as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

division:
- top-level: |-
    SELECT age / 20
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT age / 20 as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

pow:
- top-level: |-
    SELECT age ^ 20, pow(age, 20)
    FROM users
    GROUP BY 1, 2
    ORDER BY 1, 2
- sub-query: |-
    SELECT val, val2 FROM (
      SELECT age ^ 20 as val, pow(age, 20)
      FROM users
    ) as users
    GROUP BY 1, 2
    ORDER BY 1, 2

abs:
- top-level: |-
    SELECT bucket(abs(height) by 10)
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT bucket(val by 10) FROM (
      SELECT abs(height) as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

btrim:
- top-level: |-
    SELECT btrim(name)
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT btrim(name) as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

ceil:
- top-level: |-
    SELECT
      bucket(ceil(height) by 10),
      bucket(ceiling(height) by 10)
    FROM users
    GROUP BY 1, 2
    ORDER BY 1, 2
- sub-query: |-
    SELECT
      bucket(val by 10),
      bucket(val2 by 10)
    FROM (
      SELECT
        ceil(height) as val,
        ceiling(height) as val2
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

date_trunc:
- year: |-
    SELECT date_trunc('year', date), val
    FROM (
      SELECT
        uid,
        date_trunc('year', changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
    ORDER BY 1, 2
- quarter: |-
    SELECT date_trunc('quarter', date), val
    FROM (
      SELECT
        uid,
        date_trunc('quarter', changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
    ORDER BY 1, 2
- month: |-
    SELECT date_trunc('month', date), val
    FROM (
      SELECT
        uid,
        date_trunc('month', changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
    ORDER BY 1, 2
- day: |-
    SELECT date_trunc('day', date), val
    FROM (
      SELECT
        uid,
        date_trunc('day', changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
    ORDER BY 1, 2
- hour: |-
    SELECT date_trunc('hour', date), val
    FROM (
      SELECT
        uid,
        date_trunc('hour', changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
    ORDER BY 1, 2
- second: |-
    SELECT date_trunc('second', date), val
    FROM (
      SELECT
        uid,
        date_trunc('second', changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
    ORDER BY 1, 2

day:
- query: |-
    SELECT day(date), val
    FROM (
      SELECT
        uid,
        day(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

div:
- query: |-
    SELECT div(age, 2), val
    FROM (
      SELECT
        id,
        div(age, 2) as val,
        age
      FROM users
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

floor:
- query: |-
    SELECT floor(height), val
    FROM (
      SELECT
        id,
        floor(height) as val,
        height
      FROM users
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

hex:
- query: |-
    SELECT hex(name), val
    FROM (
      SELECT
        id,
        hex(name) as val,
        name
      FROM users
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

hour:
- query: |-
    SELECT hour(date), val
    FROM (
      SELECT
        uid,
        hour(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

length:
- query: |-
    SELECT length(name), val
    FROM (
      SELECT
        id,
        length(name) as val,
        name
      FROM users
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

lower:
- query: |-
    SELECT lower(name), val
    FROM (
      SELECT
        id,
        lower(name) as val,
        name
      FROM users
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

ltrim:
- query: |-
    SELECT ltrim(name), val
    FROM (
      SELECT
        id,
        ltrim(name) as val,
        name
      FROM users
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

minute:
- query: |-
    SELECT minute(date), val
    FROM (
      SELECT
        uid,
        minute(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

month:
- query: |-
    SELECT month(date), val
    FROM (
      SELECT
        uid,
        month(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

quarter:
- query: |-
    SELECT quarter(date), val
    FROM (
      SELECT
        uid,
        quarter(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

right:
- query: |-
    SELECT
      right(name, 2),
      val
    FROM (
      SELECT
        right(name, 2) as val,
        name
      FROM users
    ) users
    GROUP BY 1, 2
    ORDER BY 1, 2

round:
- top-level: |-
    SELECT bucket(round(height) by 10)
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT bucket(val by 10) FROM (
      SELECT round(height) as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

rtrim:
- top-level: |-
    SELECT rtrim(name)
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT rtrim(name) as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

second:
- query: |-
    SELECT second(date), val
    FROM (
      SELECT
        uid,
        second(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

sqrt:
- query: |-
    SELECT
      sqrt(age),
      val
    FROM (
      SELECT
        sqrt(age) as val,
        age
      FROM users
    ) users
    GROUP BY 1, 2
    ORDER BY 1, 2

substring:
- query: |-
    SELECT
      substring(name FROM 3),
      substring(name FROM 2 FOR 2),
      substring(name FOR 2),
      val,
      val2,
      val3
    FROM (
      SELECT
        substring(name FROM 3) as val,
        substring(name FROM 2 FOR 2) as val2,
        substring(name FOR 2) as val3,
        name
      FROM users
    ) users
    GROUP BY 1, 2, 3, 4, 5, 6
    ORDER BY 1, 2, 3, 4, 5, 6

trim:
- top-level: |-
    SELECT trim(name)
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT val FROM (
      SELECT trim(name) as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

trunc.:
- top-level: |-
    SELECT bucket(trunc.(height) by 10)
    FROM users
    GROUP BY 1
    ORDER BY 1
- sub-query: |-
    SELECT bucket(val by 10) FROM (
      SELECT trunc.(height) as val
      FROM users
    ) as users
    GROUP BY 1
    ORDER BY 1

upper:
- query: |-
    SELECT
      upper(name),
      ucase(name),
      val,
      val2
    FROM (
      SELECT
        id,
        upper(name) as val,
        ucase(name) as val2,
        name
      FROM users
      GROUP BY 1, 2, 3, 4
    ) changes
    GROUP BY 1, 2, 3, 4
    ORDER BY 1, 2, 3, 4

weekday:
- query: |-
    SELECT weekday(date), val
    FROM (
      SELECT
        uid,
        weekday(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2

year:
- query: |-
    SELECT year(date), val
    FROM (
      SELECT
        uid,
        year(changes.date) as val,
        changes.date as date
      FROM drafts_changes
      GROUP BY 1, 2, 3
    ) changes
    GROUP BY 1, 2
